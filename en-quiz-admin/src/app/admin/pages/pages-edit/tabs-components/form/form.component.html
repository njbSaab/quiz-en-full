<section class="pages">
  <div class="flex items-center gap-4">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="48"
      height="48"
      viewBox="0 0 24 24"
      class="text-indigo-500"
    >
      <g
        fill="none"
        stroke="#6366f1"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
      >
        <path stroke-dasharray="20" stroke-dashoffset="20" d="M3 21h18">
          <animate
            fill="freeze"
            attributeName="stroke-dashoffset"
            dur="0.2s"
            values="20;0"
          />
        </path>
        <path
          fill="#6366f1"
          fill-opacity="0"
          stroke-dasharray="48"
          stroke-dashoffset="48"
          d="M7 17v-4l10 -10l4 4l-10 10h-4"
        >
          <animate
            fill="freeze"
            attributeName="fill-opacity"
            begin="1.1s"
            dur="0.5s"
            values="0;1"
          />
          <animate
            fill="freeze"
            attributeName="stroke-dashoffset"
            begin="0.2s"
            dur="0.6s"
            values="48;0"
          />
        </path>
        <path stroke-dasharray="8" stroke-dashoffset="8" d="M14 6l4 4">
          <animate
            fill="freeze"
            attributeName="stroke-dashoffset"
            begin="0.8s"
            dur="0.2s"
            values="8;0"
          />
        </path>
      </g>
    </svg>
    <h2 class="text-3xl font-bold text-indigo-600">
      Редактировать Форму результатов (Quiz Result)
    </h2>
  </div>

  <div class="flex flex-row gap-12 items-start pb-20">
    <!-- Левая часть: Редактор -->
    <div class="w-full max-w-[600px]">
      <div class="space-y-2">
        <div>
          <label class="label font-medium">Главный заголовок</label>
          <input
            [(ngModel)]="editableContent.title"
            (input)="onFieldChange()"
            class="input input-bordered w-full"
          />
        </div>

        <div>
          <label class="label font-medium">Подзаголовок</label>
          <input
            [(ngModel)]="editableContent.subtitle"
            (input)="onFieldChange()"
            class="input input-bordered w-full"
          />
        </div>
      </div>

      <div>
        <h3 class="text-xl pt-6 font-semibold">Поля формы</h3>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="label font-medium">Плейсхолдер имени</label>
            <input
              [(ngModel)]="editableContent.namePlaceholder"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
          <div>
            <label class="label font-medium">Ошибка имени</label>
            <input
              [(ngModel)]="editableContent.nameError"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="label font-medium">Плейсхолдер email</label>
            <input
              [(ngModel)]="editableContent.emailPlaceholder"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
          <div>
            <label class="label font-medium">Ошибка email</label>
            <input
              [(ngModel)]="editableContent.emailError"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="label font-medium">Плейсхолдер кода</label>
            <input
              [(ngModel)]="editableContent.codePlaceholder"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
          <div>
            <label class="label font-medium">Ошибка кода</label>
            <input
              [(ngModel)]="editableContent.codeError"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
        </div>

        <div>
          <label class="label font-medium">Текст успеха кода</label>
          <input
            [(ngModel)]="editableContent.codeSuccess"
            (input)="onFieldChange()"
            class="input input-bordered w-full"
          />
        </div>

        <div>
          <label class="label font-medium">Ссылка "Переотправить код"</label>
          <input
            [(ngModel)]="editableContent.resendLink"
            (input)="onFieldChange()"
            class="input input-bordered w-full"
          />
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="label font-medium">Текст кнопки "Продолжить"</label>
            <input
              [(ngModel)]="editableContent.buttonContinue"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
          <div>
            <label class="label font-medium">Текст кнопки "Отправить"</label>
            <input
              [(ngModel)]="editableContent.buttonSubmit"
              (input)="onFieldChange()"
              class="input input-bordered w-full"
            />
          </div>
        </div>

        <div>
          <label class="label font-medium"
            >Текст кнопки "Закрыть" в алерте</label
          >
          <input
            [(ngModel)]="editableContent.closeButton"
            (input)="onFieldChange()"
            class="input input-bordered w-full"
          />
        </div>
      </div>

      <!-- Сохранение -->
      <div class="flex items-center justify-between mt-8">
        <div class="flex flex-col items-center gap-4 w-full">
          <button
            class="btn btn-success btn-save"
            (click)="saveManually()"
            [disabled]="saving"
          >
            <span class="loading loading-spinner" *ngIf="saving"></span>
            Сохранить изменения
          </button>

          <div
            class="text-sm"
            [ngClass]="{
              'text-success': saveStatus === 'success',
              'text-error': saveStatus === 'error',
              'text-info': saveStatus === 'saving',
            }"
          >
            {{ saveMessage || 'Автосохранение через 1.5с после изменения' }}
          </div>
        </div>
      </div>
    </div>

    <!-- Правая часть: Живое превью — точная копия реальной страницы -->
    <div class="flex-1 overflow-hidden rounded-2xl shadow-2xl">
      <div
        class="quiz-result h-space bg-gradient-primary-90 mx-w-1024 h-screen"
      >
        <div class="container flex flex-col h-full justify-center">
          <div class="result-wrapper relative">
            <h2 class="text-xl text-center pb-3 text-balance text-white">
              {{ editableContent.title }}
            </h2>

            <form class="form justify-center bg-base-100 relative">
              <div class="form-wrapper">
                <h3 class="text-xl text-center text-white">
                  {{ editableContent.subtitle }}
                </h3>

                <!-- Имя -->
                <label
                  class="input input-bordered flex items-center gap-1 relative"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 16 16"
                    fill="currentColor"
                    class="opacity-70"
                  >
                    <path
                      d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.139a6.002 6.002 0 0 0-11.215 0c-.22.578.254 1.139.872 1.139h9.47Z"
                    />
                  </svg>
                  <input
                    type="text"
                    class="grow"
                    [placeholder]="editableContent.namePlaceholder"
                  />
                  <small class="text-red-400 error absolute">
                    {{ editableContent.nameError }}
                  </small>
                </label>

                <!-- Email -->
                <label
                  class="input input-bordered flex items-center gap-1 relative"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 16 16"
                    fill="currentColor"
                    class="opacity-70"
                  >
                    <path
                      d="M2.5 3A1.5 1.5 0 0 0 1 4.5v.793c.026.009.051.02.076.032L7.674 8.51c.206.1.446.1.652 0l6.598-3.185A.755.755 0 0 1 15 5.293V4.5A1.5 1.5 0 0 0 13.5 3h-11Z"
                    />
                    <path
                      d="M15 6.954 8.978 9.86a2.25 2.25 0 0 1-1.956 0L1 6.954V11.5A1.5 1.5 0 0 0 2.5 13h11a1.5 1.5 0 0 0 1.5-1.5V6.954Z"
                    />
                  </svg>
                  <input
                    type="text"
                    class="grow"
                    [placeholder]="editableContent.emailPlaceholder"
                  />
                  <small class="text-red-400 error absolute">
                    {{ editableContent.emailError }}
                  </small>
                </label>

                <!-- Код (пример видимости) -->
                <label
                  class="input input-bordered flex items-center gap-2 relative mb-8"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="32"
                    height="32"
                    viewBox="0 0 24 24"
                    class="w-[20px]"
                  >
                    <path
                      fill="currentColor"
                      d="M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41c-.24.13-.54.04-.68-.2a.506.506 0 0 1 .2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52c.25.13.34.43.21.67a.49.49 0 0 1-.44.28M3.5 9.72a.499.499 0 0 1-.41-.79c.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25a.5.5 0 0 1-.12.7c-.23.16-.54.11-.7-.12a9.4 9.4 0 0 0-3.39-2.94c-2.87-1.47-6.54-1.47-9.4.01c-1.36.7-2.5 1.7-3.4 2.96c-.08.14-.23.21-.39.21m6.25 12.07a.47.47 0 0 1-.35-.15c-.87-.87-1.34-1.43-2.01-2.64c-.69-1.23-1.05-2.73-1.05-4.34c0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39s-4.66 1.97-4.66 4.39c0 1.44.32 2.77.93 3.85c.64 1.15 1.08 1.64 1.85 2.42c.19.2.19.51 0 .71c-.11.1-.24.15-.37.15m7.17-1.85c-1.19 0-2.24-.3-3.1-.89c-1.49-1.01-2.38-2.65-2.38-4.39c0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56c.71.48 1.54.71 2.54.71c.24 0 .64-.03 1.04-.1c.27-.05.53.13.58.41c.05.27-.13.53-.41.58c-.57.11-1.07.12-1.21.12M14.91 22c-.04 0-.09-.01-.13-.02c-1.59-.44-2.63-1.03-3.72-2.1a7.3 7.3 0 0 1-2.17-5.22c0-1.62 1.38-2.94 3.08-2.94s3.08 1.32 3.08 2.94c0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83c-2.84 0-5.44 1.58-6.61 4.03c-.39.81-.59 1.76-.59 2.8c0 .78.07 2.01.67 3.61c.1.26-.03.55-.29.64c-.26.1-.55-.04-.64-.29a11.1 11.1 0 0 1-.73-3.96c0-1.2.23-2.29.68-3.24c1.33-2.79 4.28-4.6 7.51-4.6c4.55 0 8.25 3.51 8.25 7.83c0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51c.95.94 1.86 1.46 3.27 1.85c.27.07.42.35.35.61c-.05.23-.26.38-.47.38"
                    />
                  </svg>
                  <input
                    type="text"
                    class="grow"
                    [placeholder]="editableContent.codePlaceholder"
                  />
                  <small class="text-red-400 error">
                    {{ editableContent.codeError }}
                  </small>
                  <small class="text-success">
                    {{ editableContent.codeSuccess }}
                  </small>
                  <span
                    class="link absolute bottom-[-20px] right-0 opacity-65 text-xs hover:opacity-100 transition"
                  >
                    {{ editableContent.resendLink }}
                  </span>
                </label>
              </div>

              <button
                type="submit"
                class="btn btn-primary btn-form rounded-none flex items-center justify-center gap-2"
              >
                {{ editableContent.buttonContinue }}
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
