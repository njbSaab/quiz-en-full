<section class="pages">
  <!-- home.component.html -->
  <div class="flex items-center gap-4">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="48"
      height="48"
      viewBox="0 0 24 24"
      class="text-indigo-500"
    >
      <g
        fill="none"
        stroke="#6366f1"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
      >
        <path stroke-dasharray="20" stroke-dashoffset="20" d="M3 21h18">
          <animate
            fill="freeze"
            attributeName="stroke-dashoffset"
            dur="0.2s"
            values="20;0"
          />
        </path>
        <path
          fill="#6366f1"
          fill-opacity="0"
          stroke-dasharray="48"
          stroke-dashoffset="48"
          d="M7 17v-4l10 -10l4 4l-10 10h-4"
        >
          <animate
            fill="freeze"
            attributeName="fill-opacity"
            begin="1.1s"
            dur="0.5s"
            values="0;1"
          />
          <animate
            fill="freeze"
            attributeName="stroke-dashoffset"
            begin="0.2s"
            dur="0.6s"
            values="48;0"
          />
        </path>
        <path stroke-dasharray="8" stroke-dashoffset="8" d="M14 6l4 4">
          <animate
            fill="freeze"
            attributeName="stroke-dashoffset"
            begin="0.8s"
            dur="0.2s"
            values="8;0"
          />
        </path>
      </g>
    </svg>
    <h2 class="text-3xl font-bold text-indigo-600">
      Редактировать главную страницу
    </h2>
  </div>
  <div class="flex flex-row gap-10 items-start mt-8">
    <!-- Левая часть: Редактор -->
    <div class="w-full max-w-[500px] space-y-4">
      <!-- Фон -->
      <div class="space-y-3">
        <label class="font-medium text-gray-700"
          >Фоновое изображение (URL)</label
        >
        <input
          [(ngModel)]="editableContent.backgroundImage"
          (input)="onFieldChange()"
          type="text"
          placeholder="https://i.ibb.co/..."
          class="input input-bordered w-full ring ring-gray-100"
        />
      </div>

      <!-- Заголовок баннера -->
      <div class="space-y-3">
        <label class="font-medium text-gray-700">Заголовок баннера</label>
        <textarea
          [(ngModel)]="editableContent.banner.title"
          (input)="onFieldChange()"
          rows="2"
          class="textarea textarea-bordered w-full ring ring-gray-100 resize-none"
          placeholder="先玩再說，其他等一下！"
        >
        </textarea>
      </div>

      <!-- Подзаголовок -->
      <div class="space-y-3">
        <label class="font-medium text-gray-700">Подзаголовок</label>
        <textarea
          [(ngModel)]="editableContent.banner.subtitle"
          (input)="onFieldChange()"
          rows="4"
          class="textarea textarea-bordered w-full ring ring-gray-100 resize-none"
          placeholder="60 秒小測驗樂園..."
        >
        </textarea>
      </div>

      <!-- Кнопки -->
      <div class="grid grid-cols-2 gap-6">
        <div class="space-y-3">
          <label class="font-medium text-gray-700">Текст кнопки "Начать"</label>
          <input
            [(ngModel)]="editableContent.banner.playBtn.text"
            (input)="onFieldChange()"
            type="text"
            class="input input-bordered w-full ring ring-gray-100"
            placeholder="立即開始"
          />
        </div>
        <div class="space-y-3">
          <label class="font-medium text-gray-700"
            >Текст кнопки "Все квизы"</label
          >
          <input
            [(ngModel)]="editableContent.banner.listQsBtn.text"
            (input)="onFieldChange()"
            type="text"
            class="input input-bordered w-full ring ring-gray-100"
            placeholder="所有測驗"
          />
        </div>
      </div>

      <div class="flex items-center justify-between mt-4">
        <div class="flex flex-col items-center gap-4 w-full">
          <button
            class="btn btn-success btn-save"
            (click)="saveManually()"
            [disabled]="saving"
          >
            <span class="loading loading-spinner" *ngIf="saving"></span>
            Сохранить изменения
          </button>

          <div
            class="text-sm font-medium"
            [ngClass]="{
              'text-success': saveStatus === 'success',
              'text-error': saveStatus === 'error',
              'text-info': saveStatus === 'saving',
              'text-gray-500': saveStatus === 'idle',
            }"
          >
            {{ saveMessage || 'Автосохранение через 1.5с после изменения' }}
          </div>
        </div>
      </div>
    </div>

    <!-- Правая часть: Живое превью -->
    <div
      class="flex-1 bg-gray-50 rounded-2xl shadow-2xl overflow-hidden max-w-3xl sticky top-4"
    >
      <section
        class="overflow-hidden h-full banner relative min-h-[62dvh]"
        [style.--custom-bg]="editableContent.backgroundImage"
      >
        <div
          class="absolute left-0 top-0 w-full h-full"
          *ngIf="editableContent.backgroundImage"
        >
          <img
            [src]="editableContent.backgroundImage"
            class="h-full w-full object-cover"
            alt="Background"
          />
        </div>

        <div class="absolute inset-0 -z-10">
          <div
            class="absolute -top-40 left-1/2 -translate-x-1/2 h-[32rem] w-[32rem] rounded-full blur-3xl opacity-20"
            style="
              background: radial-gradient(
                closest-side,
                #a78bfa,
                transparent 70%
              );
            "
          ></div>
          <div
            class="absolute top-40 right-10 h-64 w-64 rounded-full blur-3xl opacity-25"
            style="
              background: radial-gradient(
                closest-side,
                #22d3ee,
                transparent 70%
              );
            "
          ></div>
        </div>

        <div
          class="mx-auto max-w-1024 px-4 sm:px-6 lg:px-8 pb-10 relative z-10"
        >
          <div class="max-w-[800px] mx-auto pt-32">
            <h1
              class="text-2xl sm:text-4xl font-extrabold leading-tight mx-auto text-center text-white drop-shadow-lg"
            >
              {{ editableContent.banner.title || '先玩再說，其他等一下！' }}
            </h1>
            <p
              class="mt-4 sm:mt-6 text-slate-200 text-base sm:text-lg max-w-2xl mx-auto text-center drop-shadow"
            >
              {{
                editableContent.banner.subtitle ||
                  '60 秒小測驗樂園 —— 保證讓你笑、讓你驚呼「哇」、玩完還會想分享給朋友。挑一個主題，馬上開始！'
              }}
            </p>

            <div
              class="mt-8 flex flex-col sm:flex-row gap-4 mx-auto justify-center"
            >
              <a
                href="#"
                class="inline-flex items-center justify-center rounded-2xl px-6 py-4 text-base font-semibold bg-gradient-to-r from-fuchsia-500 to-cyan-400 text-slate-950 shadow-lg hover:opacity-95 transition"
              >
                {{ editableContent.banner.playBtn.text || '立即開始' }}
              </a>
              <a
                href="#"
                class="inline-flex items-center justify-center rounded-2xl px-6 py-4 text-base font-semibold bg-white/10 backdrop-blur border border-white/20 text-white hover:bg-white/20 transition"
              >
                {{ editableContent.banner.listQsBtn.text || '所有測驗' }}
              </a>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</section>
